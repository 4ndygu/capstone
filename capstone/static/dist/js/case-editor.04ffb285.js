(function(t){function e(e){for(var r,i,s=e[0],c=e[1],l=e[2],u=0,h=[];u<s.length;u++)i=s[u],n[i]&&h.push(n[i][0]),n[i]=0;for(r in c)Object.prototype.hasOwnProperty.call(c,r)&&(t[r]=c[r]);d&&d(e);while(h.length)h.shift()();return o.push.apply(o,l||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],r=!0,s=1;s<a.length;s++){var c=a[s];0!==n[c]&&(r=!1)}r&&(o.splice(e--,1),t=i(i.s=a[0]))}return t}var r={},n={"case-editor":0},o=[];function i(e){if(r[e])return r[e].exports;var a=r[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=r,i.d=function(t,e,a){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(i.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(a,r,function(e){return t[e]}.bind(null,r));return a},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/static/dist/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=e,s=s.slice();for(var l=0;l<s.length;l++)e(s[l]);var d=c;o.push([10,"chunk-common"]),a()})({10:function(t,e,a){t.exports=a("1a45")},"1a45":function(t,e,a){"use strict";a.r(e);var r=a("a4b5"),n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"edit-app"}},[a("div",{staticClass:"row p-2"},[a("div",{staticClass:"col-6"},[a("h1",[a("a",{attrs:{href:t.urls.case}},[t._v(t._s(t.templateVars.citation_full))])])]),a("div",{staticClass:"col-6 text-right viz-controls"},[a("button",{class:{"toggle-btn":!0,on:t.showOcr},on:{click:function(e){t.showOcr=!t.showOcr}}},[t._v("(^O)CR")]),a("button",{class:{"toggle-btn":!0,on:t.showConfidence},on:{click:function(e){t.showConfidence=!t.showConfidence}}},[t._v("W(^C)")]),a("button",{staticClass:"toggle-btn off",on:{click:t.toggleInstructions}},[t._v("help")]),a("button",{staticClass:"btn-primary mr-1 mb-1 ml-3",on:{click:function(e){return t.saveCase(e)}}},[t._v("(^s)ave case to DB")]),a("button",{staticClass:"btn-secondary",on:{click:t.clearEdits}},[t._v("Clear All Edits")]),a("span",{attrs:{"aria-live":"polite"}},[t.saveStatus?a("span",{staticClass:"ml-1"},[a("br"),t._v(t._s(t.saveStatus))]):t._e()])])]),a("div",{staticClass:"tools-row row"},[a("div",{staticClass:"scrollable col-4"},[a("h4",{staticClass:"section-title"},[t._v("current word")]),a("div",{style:t.currentWordStyle()}),a("div",{staticClass:"row"},[a("div",{staticClass:"col-10"},[a("input",{ref:"currentWord",attrs:{type:"text",id:"current_word",placeholder:"current word"},domProps:{value:t.currentWord?t.currentWord.string:""},on:{input:function(e){return t.wordEdited(e.target.value)}}})]),a("div",{staticClass:"col-2"},[a("button",{attrs:{disabled:null===t.currentWord},on:{click:function(e){return t.addSoftHyphen()}}},[t._v("⧟")])])])]),a("div",{staticClass:"scrollable col-4 edits-container"},[a("h4",{staticClass:"section-title"},[t._v("edits")]),a("div",{staticClass:"edited-word-list mt-3"},t._l(t.editedWords,function(e){return a("div",{key:e.id,staticClass:"row edit-entry"},[a("div",{staticClass:"col-5 word",on:{click:function(a){return t.wordClicked(e)}}},[t._v(t._s(e.originalString))]),a("div",{staticClass:"col-6 word",on:{click:function(a){return t.wordClicked(e)}}},[t._v(t._s(e.string))]),a("div",{staticClass:"col-1 edit-controls"},[a("span",{staticClass:"edit-delete",on:{click:function(a){return t.removeEdit(e.id)}}},[t._v("⊗")])])])}),0)]),a("div",{staticClass:"scrollable col-4"},[a("h4",{staticClass:"section-title"},[t._v("case metadata")]),a("div",{staticClass:"row"},[a("label",{staticClass:"col-8 m-0",attrs:{for:"metadata-human-corrected"}},[t._v("Human Corrected")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.metadata.human_corrected,expression:"metadata.human_corrected"}],staticClass:"col-4",attrs:{type:"checkbox",id:"metadata-human-corrected"},domProps:{checked:Array.isArray(t.metadata.human_corrected)?t._i(t.metadata.human_corrected,null)>-1:t.metadata.human_corrected},on:{change:function(e){var a=t.metadata.human_corrected,r=e.target,n=!!r.checked;if(Array.isArray(a)){var o=null,i=t._i(a,o);r.checked?i<0&&t.$set(t.metadata,"human_corrected",a.concat([o])):i>-1&&t.$set(t.metadata,"human_corrected",a.slice(0,i).concat(a.slice(i+1)))}else t.$set(t.metadata,"human_corrected",n)}}}),a("small",{staticClass:"form-text text-muted"},[t._v('Set "Human Corrected" if this case has been fully corrected and is essentially error-free.')]),a("label",{staticClass:"col-4",attrs:{for:"metadata-name-abbreviation"}},[t._v("Short Name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.metadata.name_abbreviation,expression:"metadata.name_abbreviation"}],staticClass:"col-8",attrs:{type:"text",placeholder:"case short name",id:"metadata-name-abbreviation"},domProps:{value:t.metadata.name_abbreviation},on:{input:function(e){e.target.composing||t.$set(t.metadata,"name_abbreviation",e.target.value)}}}),a("label",{staticClass:"col-4",attrs:{for:"metadata-name"}},[t._v("Long Name")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.metadata.name,expression:"metadata.name"}],staticClass:"col-8",attrs:{type:"text",placeholder:"case name",id:"metadata-name"},domProps:{value:t.metadata.name},on:{input:function(e){e.target.composing||t.$set(t.metadata,"name",e.target.value)}}}),a("label",{staticClass:"col-4",attrs:{for:"metadata-decision-date-original"}},[t._v("Decision Date (YYYY-MM-DD)")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.metadata.decision_date_original,expression:"metadata.decision_date_original"}],staticClass:"col-8",attrs:{type:"text",placeholder:"decision date",id:"metadata-decision-date-original"},domProps:{value:t.metadata.decision_date_original},on:{input:function(e){e.target.composing||t.$set(t.metadata,"decision_date_original",e.target.value)}}}),a("label",{staticClass:"col-4",attrs:{for:"metadata-docket-number"}},[t._v("Docket Number")]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.metadata.docket_number,expression:"metadata.docket_number"}],staticClass:"col-8",attrs:{type:"text",placeholder:"docket number",id:"metadata-docket-number"},domProps:{value:t.metadata.docket_number},on:{input:function(e){e.target.composing||t.$set(t.metadata,"docket_number",e.target.value)}}})])])]),a("div",{staticClass:"row",staticStyle:{flex:"1 1 auto","overflow-y":"auto"}},[a("div",{staticClass:"scrollable col-6",attrs:{id:"textView"}},t._l(t.opinions,function(e){return a("div",{staticClass:"opinion"},[a("h4",{staticClass:"section-title"},[t._v("opinion: "+t._s(e.type))]),t._l(e.paragraphs,function(e){return a("div",{key:e.id,staticClass:"paragraph"},[a("span",{staticClass:"paragraph-class"},[t._v(t._s(e.class))]),t._l(t.paragraphBlocks(e),function(e){return t._l(e.words,function(e){return t.mounted?a("span",{key:e.id,ref:"wordText"+e.id,refInFor:!0,class:t.wordClass(e),style:t.wordTextStyle(e),on:{click:function(a){return t.wordClicked(e)}}},[t._v(t._s(e.stringWithoutSoftHyphens))]):t._e()})})],2)}),e.footnotes&&e.footnotes.length?a("div",[a("h4",{staticClass:"section-title"},[t._v(t._s(e.type)+" footnotes")]),t._l(e.footnotes,function(e){return a("div",{key:e.id},[a("span",[t._v(t._s(e.label))]),t._l(e.paragraphs,function(e){return a("div",{key:e.id},[a("span",{staticClass:"paragraph-class"},[t._v(t._s(e.class))]),t._l(t.paragraphBlocks(e),function(e){return t._l(e.words,function(e){return t.mounted?a("span",{key:e.id,ref:"wordText"+e.id,refInFor:!0,class:t.wordClass(e),style:t.wordTextStyle(e),on:{click:function(a){return t.wordClicked(e)}}},[t._v(t._s(e.stringWithoutSoftHyphens))]):t._e()})})],2)})],2)})],2):t._e()],2)}),0),a("div",{ref:"pageImageContainer",staticClass:"scrollable col-6",attrs:{id:"imageView"}},t._l(t.pages,function(e){return a("div",{key:e.id,ref:"pageImages",refInFor:!0,class:{page:!0,"show-ocr":t.showOcr}},[a("img",{attrs:{src:e.image_url,width:e.width*e.scale,height:e.height*e.scale}}),t._l(e.words,function(r){return t.mounted?a("span",{key:r.id,ref:"wordImage"+r.id,refInFor:!0,class:t.wordClass(r),style:t.wordImageStyle(e,r),on:{click:function(e){return t.wordClicked(r)}}},[t._v("\n          "+t._s(r.string)+"\n        ")]):t._e()})],2)}),0)]),a("div",{staticClass:"pt-6",staticStyle:{display:"none"},attrs:{id:"instructions_modal_overlay"}},[a("div",{staticClass:"col-8 offset-2 p-5",attrs:{id:"instructions_modal"}},[a("div",{attrs:{id:"modal_close"},on:{click:t.toggleInstructions}},[t._v("⊗")]),t._m(0),t._m(1),t._m(2),t._m(3)])])])},o=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row pt-3"},[a("div",{staticClass:"q col-3"},[t._v("When should I press “Save”?")]),a("div",{staticClass:"a col-9 pl-3"},[t._v("\n          Corrections to a case should be made in a batch, and you should only press “save” when you have made all changes you intend to make to a case. This avoids preserving intermediate edits on the server that aren’t needed. In the meantime, each change you make will be immediately stored to your local browser storage, and will be stored across restarts until you are ready to save.\n        ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row pt-3"},[a("div",{staticClass:"q col-3"},[t._v("Why is there a space after each word?")]),a("div",{staticClass:"a col-9 pl-3"},[t._v("\n          The space after each word should be preserved (if it is supposed to be there) -- it controls whether there will be a space between that word and the next word when they are combined into text.\n        ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row pt-3"},[a("div",{staticClass:"q col-3"},[t._v("What is the significance of the word confidence labels?")]),a("div",{staticClass:"a col-9 pl-3"},[t._v("\n          The word confidence button highlights words that the OCR engine was less confident about. Word confidence is labeled by the OCR engine on a scale from 0.0 (least confident) to 1.0 (most confident). These scores have no objective meaning.\n        ")])])},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"row pt-3"},[a("div",{staticClass:"q col-3"},[t._v("What is the “⧟” button for?")]),a("div",{staticClass:"a col-9 pl-3"},[t._v("\n          The “⧟” button is for inserting a “soft hyphen.” When the OCR engine sees a hyphen at the end of a line, it has to guess whether to encode the hyphen as a “hard hyphen,” which should be preserved in the text, or a “soft hyphen,” an invisible character which indicates where the word was broken over the line but should not be preserved in text."),a("br"),t._v("\n          For example, if the OCR engine saw “hyphen-” at the end of one line, and “ated” at the start of the next line, it needed to decide whether the text output should be “hyphen-ated” or “hyphenated.” If the engine wrongly output “hyphen-ated”, you could use the soft hyphen button to change it to “hyphen⧟” “ated”, which would render as “hyphenated” in the text.\n        ")])])}],i=(a("a0c4"),a("e9de"),a("c1c3"),a("477f")),s=(a("6ac6"),a("d2d3")),c=(a("67c8"),a("fa38"),a("0012"),a("8430")),l=(a("baa4"),a("5b54"),a("2bf3"),a("ef92"),a("45bc")),d=a("a881"),u=a.n(d),h=(a("ba72"),a("8df7")),f=a.n(h);function v(t){return null!=t&&"object"===typeof t&&1===t.nodeType}function m(t,e){return(!e||"hidden"!==t)&&("visible"!==t&&"clip"!==t)}function p(t){if(!t.ownerDocument||!t.ownerDocument.defaultView)return null;try{return t.ownerDocument.defaultView.frameElement}catch(e){return null}}function g(t){var e=p(t);return!!e&&(e.clientHeight<t.scrollHeight||e.clientWidth<t.scrollWidth)}function y(t,e){if(t.clientHeight<t.scrollHeight||t.clientWidth<t.scrollWidth){var a=getComputedStyle(t,null);return m(a.overflowY,e)||m(a.overflowX,e)||g(t)}return!1}function w(t,e,a,r,n,o,i,s){return o<t&&i>e||o>t&&i<e?0:o<=t&&s<=a||i>=e&&s>=a?o-t-r:i>e&&s<a||o<t&&s>a?i-e+n:0}var b=function(t,e){var a=e.scrollMode,r=e.block,n=e.inline,o=e.boundary,i=e.skipOverflowHiddenElements,s="function"===typeof o?o:function(t){return t!==o};if(!v(t))throw new TypeError("Invalid target");var c=document.scrollingElement||document.documentElement,l=[],d=t;while(v(d)&&s(d)){if(d=d.parentNode,d===c){l.push(d);break}d===document.body&&y(d)&&!y(document.documentElement)||y(d,i)&&l.push(d)}for(var u=window.visualViewport?visualViewport.width:innerWidth,h=window.visualViewport?visualViewport.height:innerHeight,f=window.scrollX||pageXOffset,m=window.scrollY||pageYOffset,p=t.getBoundingClientRect(),g=p.height,b=p.width,_=p.top,C=p.right,k=p.bottom,x=p.left,S="start"===r||"nearest"===r?_:"end"===r?k:_+g/2,W="center"===n?x+b/2:"end"===n?C:x,O=[],I=0;I<l.length;I++){var E=l[I],j=E.getBoundingClientRect(),T=j.height,M=j.width,H=j.top,$=j.right,B=j.bottom,R=j.left;if("if-needed"===a&&_>=0&&x>=0&&k<=h&&C<=u&&_>=H&&k<=B&&x>=R&&C<=$)return O;var V=getComputedStyle(E),N=parseInt(V.borderLeftWidth,10),P=parseInt(V.borderTopWidth,10),A=parseInt(V.borderRightWidth,10),F=parseInt(V.borderBottomWidth,10),z=0,D=0,L="offsetWidth"in E?E.offsetWidth-E.clientWidth-N-A:0,K="offsetHeight"in E?E.offsetHeight-E.clientHeight-P-F:0;if(c===E)z="start"===r?S:"end"===r?S-h:"nearest"===r?w(m,m+h,h,P,F,m+S,m+S+g,g):S-h/2,D="start"===n?W:"center"===n?W-u/2:"end"===n?W-u:w(f,f+u,u,N,A,f+W,f+W+b,b),z=Math.max(0,z+m),D=Math.max(0,D+f);else{z="start"===r?S-H-P:"end"===r?S-B+F+K:"nearest"===r?w(H,B,T,P,F+K,S,S+g,g):S-(H+T/2)+K/2,D="start"===n?W-R-N:"center"===n?W-(R+M/2)+L/2:"end"===n?W-$+A+L:w(R,$,M,N,A+L,W,W+b,b);var Y=E.scrollLeft,J=E.scrollTop;z=Math.max(0,Math.min(J+z,E.scrollHeight-T+K)),D=Math.max(0,Math.min(Y+D,E.scrollWidth-M+L)),S+=J-z,W+=Y-D}O.push({el:E,top:z,left:D})}return O};function _(t){return t===Object(t)&&0!==Object.keys(t).length}function C(t,e){void 0===e&&(e="auto");var a="scrollBehavior"in document.body.style;t.forEach(function(t){var r=t.el,n=t.top,o=t.left;r.scroll&&a?r.scroll({top:n,left:o,behavior:e}):(r.scrollTop=n,r.scrollLeft=o)})}function k(t){return!1===t?{block:"end",inline:"nearest"}:_(t)?t:{block:"start",inline:"nearest"}}function x(t,e){var a=!t.ownerDocument.documentElement.contains(t);if(_(e)&&"function"===typeof e.behavior)return e.behavior(a?[]:b(t,e));if(!a){var r=k(e);return C(b(t,r),r.behavior)}}var S=x,W="­",O="⧟",I={data:function(){return{pages:null,metadata:null,currentWord:null,showOcr:!1,showConfidence:!1,editedWords:{},saveStatus:null,mounted:!1}},watch:{metadata:{handler:function(){this.saveStateToStorage()},deep:!0},editedWords:{handler:function(){this.saveStateToStorage()},deep:!0}},created:function(){this.templateVars=templateVars,this.urls=this.templateVars.urls,this.opinions=this.templateVars.opinions,this.metadata=this.templateVars.metadata,this.serverMetadata=Object(l["a"])({},this.metadata),this.pages=this.templateVars.pages,this.blocksById={};var t=!0,e=!1,a=void 0;try{for(var r,n=this.pages[Symbol.iterator]();!(t=(r=n.next()).done);t=!0){var o=r.value,i=!0,s=!1,d=void 0;try{for(var u,h=o.blocks[Symbol.iterator]();!(i=(u=h.next()).done);i=!0){var f=u.value;this.blocksById[f.id]=f}}catch(W){s=!0,d=W}finally{try{i||null==h.return||h.return()}finally{if(s)throw d}}}}catch(W){e=!0,a=W}finally{try{t||null==n.return||n.return()}finally{if(e)throw a}}this.fonts=this.templateVars.fonts;for(var v=0,m=Object.keys(this.fonts);v<m.length;v++){var p=m[v];this.fonts[p]=this.processFont(this.fonts[p])}this.fonts[-1]={styles:"",family:"Times New Roman",size:12},this.charAscentCache={},this.storageKey="caseedit-".concat(this.metadata.id);var g=localStorage.getItem(this.storageKey);if(this.savedWordEdits={},g)try{var y=JSON.parse(g);if(this.savedWordEdits=y.edit_list,Object.keys(y.metadata).length>0)for(var w=0,b=Object.entries(y.metadata);w<b.length;w++){var _=Object(c["a"])(b[w],2),C=_[0],k=Object(c["a"])(_[1],2),x=k[0],S=k[1];this.metadata[C]===x&&(this.metadata[C]=S)}}catch(O){console.log("Error applying edit_list to server state",O),localStorage.removeItem(this.storageKey)}this.extractWords()},mounted:function(){var t=this;document.addEventListener("keyup",function(e){if(e.ctrlKey)switch(e.key){case"o":t.showOcr=!t.showOcr;break;case"c":t.showConfidence=!t.showConfidence;break;case"s":t.saveCase();break;default:break}});var e=!0,a=!1,r=void 0;try{for(var n,o=this.pages.entries()[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var i=Object(c["a"])(n.value,2),s=i[0],l=i[1];l.imageRef=this.$refs.pageImages[s]}}catch(d){a=!0,r=d}finally{try{e||null==o.return||o.return()}finally{if(a)throw r}}window.addEventListener("resize",function(){t.handleWindowResize()}),this.handleWindowResize(),this.mounted=!0},methods:{wordEdited:function(t){var e=this.currentWord;e.originalString===t?this.$delete(this.editedWords,e.id):this.$set(this.editedWords,e.id,e),e.string=t,e.stringWithoutSoftHyphens=e.string.replace(O,"")},paragraphBlocks:function(t){var e=this;return t.block_ids?t.block_ids.map(function(t){return e.blocksById[t]}):[]},currentWordStyle:function(){if(this.currentWord){var t=this.pagesByWordId[this.currentWord.id];return{"background-image":"url(".concat(t.image_url,")"),"background-size":"".concat(t.width,"px"),width:"".concat(this.currentWord.w,"px"),height:"".concat(this.currentWord.h,"px"),"background-position":"-".concat(this.currentWord.x,"px -").concat(this.currentWord.y,"px")}}return{width:"20rem",height:"2rem"}},wordImageStyle:function(t,e){var a=e.font;return{left:"".concat(e.x*t.scale,"px"),top:"".concat(e.y*t.scale-e.yOffset*t.fontScale-1,"px"),"background-color":this.showConfidence?e.wordConfidenceColor:"unset",font:"".concat(a.styles," ").concat(a.size*t.fontScale,"px/").concat(e.lineHeight*t.fontScale,"px ").concat(a.family)}},wordTextStyle:function(t){t.font;return{"background-color":this.showConfidence?t.wordConfidenceColor:"unset",font:"".concat(t.font.styles)}},wordClass:function(t){return{"current-word":this.currentWord===t,edited:t.string!==t.originalString,"footnote-mark":t.footnoteMark}},wordClicked:function(t){this.currentWord=t,this.$refs.currentWord.focus(),this.scrollToWord(t.id)},wordConfidenceColor:function(t){var e=100*(.6-t.wordConfidence),a=255*t.wordConfidence+127;return"rgba(".concat(a,", 0, 0, ").concat(e,"%)")},handleWindowResize:function(){var t=this.$refs.pageImageContainer.offsetWidth,e=!0,a=!1,r=void 0;try{for(var n,o=this.pages[Symbol.iterator]();!(e=(n=o.next()).done);e=!0){var i=n.value;this.$set(i,"scale",t/i.width),i.fontScale=300*i.scale/72}}catch(s){a=!0,r=s}finally{try{e||null==o.return||o.return()}finally{if(a)throw r}}},extractWords:function(){var t=this,e=0;this.pagesByWordId={};var a=!0,r=!1,n=void 0;try{for(var o,i=this.pages[Symbol.iterator]();!(a=(o=i.next()).done);a=!0){var l=o.value,d=[],u=!0,h=!1,f=void 0;try{for(var v,m=function(){var a=v.value;if(a.words=[],!a.tokens)return"continue";var r=null,n=-1,o=!1,i=t.savedWordEdits[l.id]&&t.savedWordEdits[l.id][a.id]?t.savedWordEdits[l.id][a.id]:{},u=!0,h=!1,f=void 0;try{for(var m,p=a.tokens.entries()[Symbol.iterator]();!(u=(m=p.next()).done);u=!0){var g=Object(c["a"])(m.value,2),y=g[0],w=g[1];if("string"!==typeof w){var b=Object(c["a"])(w,2),_=b[0],C=b[1];if("ocr"===_){var k=C.rect;r={blockId:a.id,wordConfidence:C.wc,font:t.fonts[n],strings:[],x:k[0],y:k[1],w:k[2],h:k[3],footnoteMark:o}}else if("/ocr"===_){if(!r)continue;if(r.strings.length){var x=d.length;r.index=x,r.originalString=r.strings.map(function(t){return t.value}).join("").replace(W,O),x in i&&i[x][0]===r.originalString?(r.string=i[x][1],t.editedWords[e]=r):r.string=r.originalString,r.stringWithoutSoftHyphens=r.string.replace(O,""),r.lineHeight=t.getFontLineHeight(n),r.yOffset=Math.min.apply(Math,Object(s["a"])(r.string.split("").map(function(e){return r.lineHeight-t.getCharAscent(e,n)}))),r.wordConfidenceColor=t.wordConfidenceColor(r),e++,r.id=e,d.push(r),a.words.push(r),t.pagesByWordId[e]=l}r=null}else"font"===_?n=C.id:"/font"===_?n=-1:"footnotemark"===_?o=!0:"/footnotemark"===_&&(o=!1)}else r&&r.strings.push({index:y,value:w})}}catch(S){h=!0,f=S}finally{try{u||null==p.return||p.return()}finally{if(h)throw f}}},p=l.blocks[Symbol.iterator]();!(u=(v=p.next()).done);u=!0)m()}catch(g){h=!0,f=g}finally{try{u||null==p.return||p.return()}finally{if(h)throw f}}l.words=d}}catch(g){r=!0,n=g}finally{try{a||null==i.return||i.return()}finally{if(r)throw n}}},toggleInstructions:function(){var t=document.getElementById("instructions_modal_overlay");t.style.display="none"===t.style.display?"block":"none"},scrollToWord:function(t){S(this.$refs["wordText".concat(t)][0],{scrollMode:"if-needed"}),S(this.$refs["wordImage".concat(t)][0],{scrollMode:"if-needed"})},removeEdit:function(t){var e=this.editedWords[t];e.string=e.originalString,this.$delete(this.editedWords,t)},clearEdits:function(){if(confirm("CONFIRM: permanently discard your edits?\nThere is no undo for this command.")){localStorage.removeItem(this.storageKey),this.metadata=Object(l["a"])({},this.serverMetadata);var t=!0,e=!1,a=void 0;try{for(var r,n=this.pages[Symbol.iterator]();!(t=(r=n.next()).done);t=!0){var o=r.value,i=!0,s=!1,c=void 0;try{for(var d,u=o.words[Symbol.iterator]();!(i=(d=u.next()).done);i=!0){var h=d.value;h.string!==h.originalString&&(h.string=h.originalString)}}catch(f){s=!0,c=f}finally{try{i||null==u.return||u.return()}finally{if(s)throw c}}}}catch(f){e=!0,a=f}finally{try{t||null==n.return||n.return()}finally{if(e)throw a}}}},getMetadataEdits:function(){for(var t={},e=0,a=Object.entries(this.metadata);e<a.length;e++){var r=Object(c["a"])(a[e],2),n=r[0],o=r[1],i=this.serverMetadata[n];o!==i&&(t[n]=[i,o])}return t},getTokenEdits:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e={},a=!0,r=!1,n=void 0;try{for(var o,i=this.pages[Symbol.iterator]();!(a=(o=i.next()).done);a=!0){var s=o.value,l=s.id,d=!0,u=!1,h=void 0;try{for(var f,v=s.words.entries()[Symbol.iterator]();!(d=(f=v.next()).done);d=!0){var m=Object(c["a"])(f.value,2),p=m[0],g=m[1];if(g.string!==g.originalString)if(e[l]||(e[l]={}),e[l][g.blockId]||(e[l][g.blockId]={}),t)e[l][g.blockId][p]=[g.originalString,g.string];else{var y=g.string.replace(O,W),w=!0,b=!1,_=void 0;try{for(var C,k=g.strings.entries()[Symbol.iterator]();!(w=(C=k.next()).done);w=!0){var x=Object(c["a"])(C.value,2),S=x[0],I=x[1];e[l][g.blockId][I.index]=[I.value,0===S?y:""]}}catch(E){b=!0,_=E}finally{try{w||null==k.return||k.return()}finally{if(b)throw _}}}}}catch(E){u=!0,h=E}finally{try{d||null==v.return||v.return()}finally{if(u)throw h}}}}catch(E){r=!0,n=E}finally{try{a||null==i.return||i.return()}finally{if(r)throw n}}return e},getState:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{metadata:this.getMetadataEdits(),edit_list:this.getTokenEdits(t)}},saveStateToStorage:f()(function(){var t=this.getState(!0);localStorage.setItem(this.storageKey,JSON.stringify(t))},500),saveCase:function(){var t=Object(i["a"])(regeneratorRuntime.mark(function t(){var e,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(e=prompt("\n        CONFIRM: permanently replace ".concat(this.templateVars.citation_full," in the CAP database with your edited version?\n        There is no undo for this command.\n        Enter a description of your edits to continue:\n      "),""),e){t.next=3;break}return t.abrupt("return");case 3:return this.saveStatus="saving ...",a=this.getState(),a.description=e,t.prev=6,t.next=9,u.a.ajax("",{type:"POST",data:JSON.stringify(a),contentType:"application/json"}).promise();case 9:t.next=15;break;case 11:return t.prev=11,t.t0=t["catch"](6),this.saveStatus="error saving: ".concat(t.t0),t.abrupt("return");case 15:localStorage.removeItem(this.storageKey),window.location.href=this.urls.case;case 17:case"end":return t.stop()}},t,this,[[6,11]])}));function e(){return t.apply(this,arguments)}return e}(),getCharAscent:function(t,e){var a="".concat(e,"-").concat(t);if(!this.charAscentCache.hasOwnProperty(a)){var r=document.createElement("canvas"),n=r.getContext("2d"),o=this.fonts[e];n.font="".concat(o.styles," ").concat(o.size,"pt ").concat(o.family),this.charAscentCache[a]=3*n.measureText(t).actualBoundingBoxAscent/4}return this.charAscentCache[a]},getFontLineHeight:function(t){return this.getCharAscent("T",t)},addSoftHyphen:function(){this.currentWord.string=this.currentWord.string+O},processFont:function(t){var e=[];return t.style.includes("italics")&&e.push("italic"),t.style.includes("smallcaps")&&e.push("small-caps"),t.style.includes("bold")&&e.push("bold"),{family:'"'.concat(t.family,'",').concat(t.type),size:parseFloat(t.size),styles:e.join(" ")}}}},E=I,j=(a("bf82"),a("a6c2")),T=Object(j["a"])(E,n,o,!1,null,"8093621e",null),M=T.exports;new r["default"]({el:"#app",components:{Main:M},template:"<Main/>"})},"2fc0":function(t,e,a){},bf82:function(t,e,a){"use strict";var r=a("2fc0"),n=a.n(r);n.a}});
//# sourceMappingURL=case-editor.04ffb285.js.map