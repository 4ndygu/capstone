{% extends "base.html" %}
{% load pipeline %}
{% block extra_head %}
  {% stylesheet 'docs' %}
{% endblock %}

{% block title %} | API guide{% endblock %}

{% block meta_description %}
  The Caselaw Access Project API guide
{% endblock %}

{% block content %}
<div class="page-header cont-fixed border-bottom">
    <div class="row">
      <h1 class="col centered-text bold-text">
        <span class="blue-text">CAP</span> API
      </h1>
    </div>
    <div class="row">
      <h3 class="col centered-text semibold-text">
        EXPLORE AMERICAN CASELAW</h3>
    </div>
    <div class="row">
      <h5 class="col centered-text light-text">
        Read the documentation below to get started
      </h5>
    </div>
  </div>

  <div class="row flex-xl-nowrap" id="api-overview">

    {% include "includes/api-doc-toc.html" %}

    <div class="col-12 col-md-9 col-xl-8 py-md-3 docs reading-body">
      <section class="border-bottom">
        <h2 id="overview-section" class="section-title">
          API Overview
        </h2>

        This API lets you traverse through American caselaw from the 1600s
        to present day.
        <br/>
        The API can be browsed through the
        <a href="/api/v1/cases/?full_case=true&jurisdiction=Ill.&body_format=text"
           target="_blank">browser</a> or using the
        <a href="#getting-started-section">command line</a>.
        <br/>
        <br/>

        The API can be browsed anonymously or with an API key.
        <br/>

        All users can:
        <ul>
          <li>See unlimited metadata (see <a href="" aria-label="unlimited metadata example">an example here</a>).</li>
        </ul>
        Anonymous users can:
        <ul>
          <li>Read whitelisted<strong>*</strong> cases' text (see <a href="">an example here</a>). </li>
        </ul>

        <strong>*</strong>Learn about whitelisting <a href="">here</a>.
        <br/>
        Registered users can:
        <ul>
          <li>
            Request up to 500 cases a day.

          </li>
        </ul>
      </section>

      <section class="border-bottom">
        <h3  id="registration-section" class="section-title">Register for an API key</h3>
        <a href="/accounts/register"
           sr-only="Register"
           class="btn blue-button">
            REGISTER
        </a>
        <br/>
        Once you have your API key, you can begin to view full blacklisted cases.
        <br/>
        <a href="/accounts/login"
           sr-only="Log in"
           class="btn blue-button">
            LOGIN
        </a>
        <br/>
        Log in to retrieve your API key and see your daily remaining case allowance.

        <p class="text-primary">
          <span class="body-text bold-text">A note about rate limiting:</span>
        <br/>
          Currently we only allow users to view <code>500 cases</code> a day. If you are a researcher
        â€¨or you need to have more access, please write to us here:
          <a href="mailto:info@capapi.org" sr-only="Email us">info@capapi.org</a>
        </p>
      </section>

      <section class="border-bottom">
        <h2 id="getting-started-section" class="section-title">Getting Started</h2>
        <p class="body-text">The metadata is viewable online as well as using the command line.</p>

        <p class="body-text">
          The main entrypoint is:
          <br/>
        <ul>
          <li>
            <a href="/api/v1/cases">https://{{ request.get_host }}/api/v1/cases</a>
          </li>
        </ul>
        </p>

        <p class="body-text bold-text">
          Searching cases by citation, reading full case text
        </p>
        The easiest way to find a specific case is by searching for it using its
        <a href="https://en.wikipedia.org/wiki/Case_citation"
           aria-label="Wikipedia entry for caselaw citation">citation</a>.
        For instance, if you are trying to find <code>1 Ill. 21</code>, here are your options:
        <ul>
          <li>
            <a href="/api/v1/cases/1 Ill. 21">
              https://{{ request.get_host }}/api/v1/cases/1 Ill. 21</a>
          </li>
          <li>
            <a href="/api/v1/cases/?cite=1-Ill-21">
              https://{{ request.get_host }}/api/v1/cases/?cite=1-ill-21</a>
          </li>
        </ul>

        <p class="body-text bold-text">
          Getting casetext (whitelisted vs. blacklisted jurisdictions)
        </p>
        All case metadata is unlimited and available to registered and anonymous users.

        See a <a href="#whitelisted-jurisdictions-section">list of whitelisted jurisdictions here</a>.
        Anyone who has an <a href="">API key</a>

        <p class="body-text bold-text">
          A note on pagination:
        </p>
        <p class="body-text">The API will return 100 items per response. If you want more than 100 items returned, you can page through the items using the <i>offset</i> parameter. For example, if you want to start at the 101st result, set the offset value to 4 (we start counting at 0, of course).</p>

        <p class="body-text">Here are some examples of endpoints and their JSON responses.</p>

        <p class="body-text">A single case request (online):</p>
        <pre><a href="/api/v1/cases/{{ case_id }}/" target="_blank">https://{{ request.get_host }}/api/v1/cases/{{ case_id }}/</a></pre>
        <p class="body-text">A single case CURL request:</p>
        <pre>$ curl "https://{{ request.get_host }}/api/v1/cases/{{ case_id }}/?format=json"</pre>
        <pre>{{ case_metadata }}
        </pre>
        <p class="body-text">A single reporter request (online):</p>
        <pre><a href="https://{{ request.get_host }}/api/v1/reporters/{{ reporter_id }}/" target="_blank">https://{{ request.get_host }}/api/v1/reporters/{{ reporter_id }}/</a></pre>
        <p class="body-text">A single reporter CURL request:</p>
        <pre>$ curl "https://{{ request.get_host }}/api/v1/reporters/{{ reporter_id }}/?format=json"</pre>
        <p>{{ reporter_metadata }}
        </p>
        The other entrypoints are:
        <br/>
        <ul class="list-group">
          <li class="list-group-item">
            <a href="/api/v1/jurisdictions">https://{{ request.get_host }}/api/v1/jurisdictions</a>
          </li>
          <li class="list-group-item">
            <a href="/api/v1/reporters">https://{{ request.get_host }}/api/v1/reporters</a>
          </li>
          <li class="list-group-item">
            <a href="/api/v1/courts">https://{{ request.get_host }}/api/v1/courts</a>
          </li>
          <li class="list-group-item">
            <a href="/api/v1/courts">https://{{ request.get_host }}/api/v1/courts</a>
          </li>
          <li class="list-group-item">
            <a href="/api/v1/volumes">https://{{ request.get_host }}/api/v1/volumes</a>
          </li>
        </ul>

      </section>

      <section class="border-bottom ">
        <h2 id="whitelisted-jurisdictions-section"
            class="section-title">Whitelisted Jurisdictions</h2>
        <ul>
          {% for jur in whitelisted_jurisdictions %}
          <li>{{ jur.name_long }}</li>
          {% endfor %}
        </ul>
        You can help us expand this list by asking your courts to digitize their caselaw!
      </section>

      <section>
        <h2 id="terms-of-use-section" class="section-title">Terms of Use</h2>
        <p class="body-text">Your use of the CAP API is subject to your acceptance of our <a href="{% url 'terms' %}">Terms of Use</a>.</p>
      </section>
    </div>
  </div>

{% endblock %}
