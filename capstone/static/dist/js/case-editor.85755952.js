(function(t){function e(e){for(var r,o,s=e[0],l=e[1],c=e[2],u=0,h=[];u<s.length;u++)o=s[u],a[o]&&h.push(a[o][0]),a[o]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(t[r]=l[r]);d&&d(e);while(h.length)h.shift()();return i.push.apply(i,c||[]),n()}function n(){for(var t,e=0;e<i.length;e++){for(var n=i[e],r=!0,s=1;s<n.length;s++){var l=n[s];0!==a[l]&&(r=!1)}r&&(i.splice(e--,1),t=o(o.s=n[0]))}return t}var r={},a={"case-editor":0},i=[];function o(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=t,o.c=r,o.d=function(t,e,n){o.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},o.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},o.t=function(t,e){if(1&e&&(t=o(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)o.d(n,r,function(e){return t[e]}.bind(null,r));return n},o.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return o.d(e,"a",e),e},o.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},o.p="/static/dist/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],l=s.push.bind(s);s.push=e,s=s.slice();for(var c=0;c<s.length;c++)e(s[c]);var d=l;i.push([10,"chunk-common"]),n()})({"052b":function(t,e,n){},10:function(t,e,n){t.exports=n("1a45")},"1a45":function(t,e,n){"use strict";n.r(e);var r=n("a4b5"),a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"edit-app"}},[n("div",{staticClass:"row p-2"},[n("div",{staticClass:"col-6"},[n("h1",[n("a",{attrs:{href:t.urls.case}},[t._v(t._s(t.templateVars.citation_full))])])]),n("div",{staticClass:"col-6 text-right viz-controls"},[n("button",{class:{"toggle-btn":!0,on:t.showOcr},on:{click:function(e){t.showOcr=!t.showOcr}}},[t._v("(^O)CR")]),n("button",{class:{"toggle-btn":!0,on:t.showConfidence},on:{click:function(e){t.showConfidence=!t.showConfidence}}},[t._v("W(^C)")]),n("button",{staticClass:"toggle-btn off",on:{click:t.toggleInstructions}},[t._v("help")]),n("button",{staticClass:"btn-primary mr-1 mb-1 ml-3",on:{click:function(e){return t.saveCase(e)}}},[t._v("(^s)ave case to DB")]),n("button",{staticClass:"btn-secondary",on:{click:t.clearEdits}},[t._v("Clear All Edits")]),n("span",{attrs:{"aria-live":"polite"}},[t.saveStatus?n("span",{staticClass:"ml-1"},[n("br"),t._v(t._s(t.saveStatus))]):t._e()])])]),n("div",{staticClass:"tools-row row"},[n("div",{staticClass:"scrollable col-4"},[n("h4",{staticClass:"section-title"},[t._v("current word")]),n("div",{style:t.currentWordStyle()}),n("div",{staticClass:"row"},[n("div",{staticClass:"col-10"},[n("input",{ref:"currentWord",attrs:{type:"text",id:"current_word",placeholder:"current word"},domProps:{value:t.currentWord?t.currentWord.string:""},on:{input:function(e){return t.wordEdited(e.target.value)}}})]),n("div",{staticClass:"col-2"},[n("button",{attrs:{disabled:null===t.currentWord},on:{click:function(e){return t.addSoftHyphen()}}},[t._v("⧟")])])])]),n("div",{staticClass:"scrollable col-4 edits-container"},[n("h4",{staticClass:"section-title"},[t._v("edits")]),n("div",{staticClass:"edited-word-list mt-3"},t._l(t.editedWords,function(e){return n("div",{key:e.id,staticClass:"row edit-entry"},[n("div",{staticClass:"col-5 word",on:{click:function(n){return t.wordClicked(e)}}},[t._v(t._s(e.originalString))]),n("div",{staticClass:"col-6 word",on:{click:function(n){return t.wordClicked(e)}}},[t._v(t._s(e.string))]),n("div",{staticClass:"col-1 edit-controls"},[n("span",{staticClass:"edit-delete",on:{click:function(n){return t.removeEdit(e.id)}}},[t._v("⊗")])])])}),0)]),n("div",{staticClass:"scrollable col-4"},[n("h4",{staticClass:"section-title"},[t._v("case metadata")]),n("div",{staticClass:"row"},[n("label",{staticClass:"col-4",attrs:{for:"metadata-name-abbreviation"}},[t._v("Short Name")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.metadata.name_abbreviation,expression:"metadata.name_abbreviation"}],staticClass:"col-8",attrs:{type:"text",placeholder:"case short name",id:"metadata-name-abbreviation"},domProps:{value:t.metadata.name_abbreviation},on:{input:function(e){e.target.composing||t.$set(t.metadata,"name_abbreviation",e.target.value)}}}),n("label",{staticClass:"col-4",attrs:{for:"metadata-name"}},[t._v("Long Name")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.metadata.name,expression:"metadata.name"}],staticClass:"col-8",attrs:{type:"text",placeholder:"case name",id:"metadata-name"},domProps:{value:t.metadata.name},on:{input:function(e){e.target.composing||t.$set(t.metadata,"name",e.target.value)}}}),n("label",{staticClass:"col-4",attrs:{for:"metadata-decision-date-original"}},[t._v("Decision Date (YYYY-MM-DD)")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.metadata.decision_date_original,expression:"metadata.decision_date_original"}],staticClass:"col-8",attrs:{type:"text",placeholder:"decision date",id:"metadata-decision-date-original"},domProps:{value:t.metadata.decision_date_original},on:{input:function(e){e.target.composing||t.$set(t.metadata,"decision_date_original",e.target.value)}}}),n("label",{staticClass:"col-4",attrs:{for:"metadata-docket-number"}},[t._v("Docket Number")]),n("input",{directives:[{name:"model",rawName:"v-model",value:t.metadata.docket_number,expression:"metadata.docket_number"}],staticClass:"col-8",attrs:{type:"text",placeholder:"docket number",id:"metadata-docket-number"},domProps:{value:t.metadata.docket_number},on:{input:function(e){e.target.composing||t.$set(t.metadata,"docket_number",e.target.value)}}})])])]),n("div",{staticClass:"row",staticStyle:{flex:"1 1 auto","overflow-y":"auto"}},[n("div",{staticClass:"scrollable col-6",attrs:{id:"textView"}},t._l(t.opinions,function(e){return n("div",{staticClass:"opinion"},[n("h4",{staticClass:"section-title"},[t._v("opinion: "+t._s(e.type))]),t._l(e.paragraphs,function(e){return n("div",{key:e.id,staticClass:"paragraph"},[n("span",{staticClass:"paragraph-class"},[t._v(t._s(e.class))]),t._l(t.paragraphBlocks(e),function(e){return t._l(e.words,function(e){return t.mounted?n("span",{key:e.id,ref:"wordText"+e.id,refInFor:!0,class:t.wordClass(e),style:t.wordTextStyle(e),on:{click:function(n){return t.wordClicked(e)}}},[t._v(t._s(e.stringWithoutSoftHyphens))]):t._e()})})],2)}),t._l(e.footnotes,function(r){return n("div",{key:r.id},[n("span",[t._v(t._s(r.label))]),t._l(e.paragraphs,function(e){return n("div",{key:e.id},[n("span",[t._v(t._s(e.class))]),t._l(t.paragraphBlocks(e),function(e){return t._l(e.words,function(e){return t.mounted?n("span",{key:e.id,ref:"wordText"+e.id,refInFor:!0,class:t.wordClass(e),style:t.wordTextStyle(e),on:{click:function(n){return t.wordClicked(e)}}},[t._v(t._s(e.stringWithoutSoftHyphens))]):t._e()})})],2)})],2)})],2)}),0),n("div",{ref:"pageImageContainer",staticClass:"scrollable col-6",attrs:{id:"imageView"}},t._l(t.pages,function(e){return n("div",{key:e.id,ref:"pageImages",refInFor:!0,class:{page:!0,"show-ocr":t.showOcr}},[n("img",{attrs:{src:e.image_url,width:e.width*e.scale,height:e.height*e.scale}}),t._l(e.words,function(r){return t.mounted?n("span",{key:r.id,ref:"wordImage"+r.id,refInFor:!0,class:t.wordClass(r),style:t.wordImageStyle(e,r),on:{click:function(e){return t.wordClicked(r)}}},[t._v("\n          "+t._s(r.string)+"\n        ")]):t._e()})],2)}),0)]),n("div",{staticClass:"pt-6",staticStyle:{display:"none"},attrs:{id:"instructions_modal_overlay"}},[n("div",{staticClass:"col-8 offset-2 p-5",attrs:{id:"instructions_modal"}},[n("div",{attrs:{id:"modal_close"},on:{click:t.toggleInstructions}},[t._v("⊗")]),t._m(0),t._m(1),t._m(2),t._m(3)])])])},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row pt-3"},[n("div",{staticClass:"q col-3"},[t._v("When should I press “Save”?")]),n("div",{staticClass:"a col-9 pl-3"},[t._v("\n          Corrections to a case should be made in a batch, and you should only press “save” when you have made all changes you intend to make to a case. This avoids preserving intermediate edits on the server that aren’t needed. In the meantime, each change you make will be immediately stored to your local browser storage, and will be stored across restarts until you are ready to save.\n        ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row pt-3"},[n("div",{staticClass:"q col-3"},[t._v("Why is there a space after each word?")]),n("div",{staticClass:"a col-9 pl-3"},[t._v("\n          The space after each word should be preserved (if it is supposed to be there) -- it controls whether there will be a space between that word and the next word when they are combined into text.\n        ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row pt-3"},[n("div",{staticClass:"q col-3"},[t._v("What is the significance of the word confidence labels?")]),n("div",{staticClass:"a col-9 pl-3"},[t._v("\n          The word confidence button highlights words that the OCR engine was less confident about. Word confidence is labeled by the OCR engine on a scale from 0.0 (least confident) to 1.0 (most confident). These scores have no objective meaning.\n        ")])])},function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"row pt-3"},[n("div",{staticClass:"q col-3"},[t._v("What is the “⧟” button for?")]),n("div",{staticClass:"a col-9 pl-3"},[t._v("\n          The “⧟” button is for inserting a “soft hyphen.” When the OCR engine sees a hyphen at the end of a line, it has to guess whether to encode the hyphen as a “hard hyphen,” which should be preserved in the text, or a “soft hyphen,” an invisible character which indicates where the word was broken over the line but should not be preserved in text."),n("br"),t._v("\n          For example, if the OCR engine saw “hyphen-” at the end of one line, and “ated” at the start of the next line, it needed to decide whether the text output should be “hyphen-ated” or “hyphenated.” If the engine wrongly output “hyphen-ated”, you could use the soft hyphen button to change it to “hyphen⧟” “ated”, which would render as “hyphenated” in the text.\n        ")])])}],o=(n("a0c4"),n("e9de"),n("1a43"),n("c1c3"),n("477f")),s=(n("6ac6"),n("d2d3")),l=(n("67c8"),n("fa38"),n("0012"),n("8430")),c=(n("baa4"),n("5b54"),n("2bf3"),n("ef92"),n("45bc")),d=n("a881"),u=n.n(d),h=(n("ba72"),n("8df7")),f=n.n(h);function v(t){return null!=t&&"object"===typeof t&&1===t.nodeType}function p(t,e){return(!e||"hidden"!==t)&&("visible"!==t&&"clip"!==t)}function m(t){if(!t.ownerDocument||!t.ownerDocument.defaultView)return null;try{return t.ownerDocument.defaultView.frameElement}catch(e){return null}}function g(t){var e=m(t);return!!e&&(e.clientHeight<t.scrollHeight||e.clientWidth<t.scrollWidth)}function y(t,e){if(t.clientHeight<t.scrollHeight||t.clientWidth<t.scrollWidth){var n=getComputedStyle(t,null);return p(n.overflowY,e)||p(n.overflowX,e)||g(t)}return!1}function w(t,e,n,r,a,i,o,s){return i<t&&o>e||i>t&&o<e?0:i<=t&&s<=n||o>=e&&s>=n?i-t-r:o>e&&s<n||i<t&&s>n?o-e+a:0}var b=function(t,e){var n=e.scrollMode,r=e.block,a=e.inline,i=e.boundary,o=e.skipOverflowHiddenElements,s="function"===typeof i?i:function(t){return t!==i};if(!v(t))throw new TypeError("Invalid target");var l=document.scrollingElement||document.documentElement,c=[],d=t;while(v(d)&&s(d)){if(d=d.parentNode,d===l){c.push(d);break}d===document.body&&y(d)&&!y(document.documentElement)||y(d,o)&&c.push(d)}for(var u=window.visualViewport?visualViewport.width:innerWidth,h=window.visualViewport?visualViewport.height:innerHeight,f=window.scrollX||pageXOffset,p=window.scrollY||pageYOffset,m=t.getBoundingClientRect(),g=m.height,b=m.width,C=m.top,_=m.right,k=m.bottom,x=m.left,S="start"===r||"nearest"===r?C:"end"===r?k:C+g/2,W="center"===a?x+b/2:"end"===a?_:x,O=[],I=0;I<c.length;I++){var E=c[I],j=E.getBoundingClientRect(),T=j.height,M=j.width,H=j.top,$=j.right,B=j.bottom,R=j.left;if("if-needed"===n&&C>=0&&x>=0&&k<=h&&_<=u&&C>=H&&k<=B&&x>=R&&_<=$)return O;var V=getComputedStyle(E),N=parseInt(V.borderLeftWidth,10),P=parseInt(V.borderTopWidth,10),F=parseInt(V.borderRightWidth,10),z=parseInt(V.borderBottomWidth,10),A=0,D=0,L="offsetWidth"in E?E.offsetWidth-E.clientWidth-N-F:0,K="offsetHeight"in E?E.offsetHeight-E.clientHeight-P-z:0;if(l===E)A="start"===r?S:"end"===r?S-h:"nearest"===r?w(p,p+h,h,P,z,p+S,p+S+g,g):S-h/2,D="start"===a?W:"center"===a?W-u/2:"end"===a?W-u:w(f,f+u,u,N,F,f+W,f+W+b,b),A=Math.max(0,A+p),D=Math.max(0,D+f);else{A="start"===r?S-H-P:"end"===r?S-B+z+K:"nearest"===r?w(H,B,T,P,z+K,S,S+g,g):S-(H+T/2)+K/2,D="start"===a?W-R-N:"center"===a?W-(R+M/2)+L/2:"end"===a?W-$+F+L:w(R,$,M,N,F+L,W,W+b,b);var Y=E.scrollLeft,J=E.scrollTop;A=Math.max(0,Math.min(J+A,E.scrollHeight-T+K)),D=Math.max(0,Math.min(Y+D,E.scrollWidth-M+L)),S+=J-A,W+=Y-D}O.push({el:E,top:A,left:D})}return O};function C(t){return t===Object(t)&&0!==Object.keys(t).length}function _(t,e){void 0===e&&(e="auto");var n="scrollBehavior"in document.body.style;t.forEach(function(t){var r=t.el,a=t.top,i=t.left;r.scroll&&n?r.scroll({top:a,left:i,behavior:e}):(r.scrollTop=a,r.scrollLeft=i)})}function k(t){return!1===t?{block:"end",inline:"nearest"}:C(t)?t:{block:"start",inline:"nearest"}}function x(t,e){var n=!t.ownerDocument.documentElement.contains(t);if(C(e)&&"function"===typeof e.behavior)return e.behavior(n?[]:b(t,e));if(!n){var r=k(e);return _(b(t,r),r.behavior)}}var S=x,W="­",O="⧟",I={data:function(){return{pages:null,metadata:null,currentWord:null,showOcr:!1,showConfidence:!1,editedWords:{},saveStatus:null,mounted:!1}},watch:{metadata:{handler:function(){this.saveStateToStorage()},deep:!0},editedWords:{handler:function(){this.saveStateToStorage()},deep:!0}},created:function(){this.templateVars=templateVars,this.urls=this.templateVars.urls,this.opinions=this.templateVars.opinions,this.metadata=this.templateVars.metadata,this.serverMetadata=Object(c["a"])({},this.metadata),this.pages=this.templateVars.pages,this.blocksById={};var t=!0,e=!1,n=void 0;try{for(var r,a=this.pages[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var i=r.value,o=!0,s=!1,d=void 0;try{for(var u,h=i.blocks[Symbol.iterator]();!(o=(u=h.next()).done);o=!0){var f=u.value;this.blocksById[f.id]=f}}catch(W){s=!0,d=W}finally{try{o||null==h.return||h.return()}finally{if(s)throw d}}}}catch(W){e=!0,n=W}finally{try{t||null==a.return||a.return()}finally{if(e)throw n}}this.fonts=this.templateVars.fonts;for(var v=0,p=Object.keys(this.fonts);v<p.length;v++){var m=p[v];this.fonts[m]=this.processFont(this.fonts[m])}this.fonts[-1]={styles:"",family:"Times New Roman",size:12},this.charAscentCache={},this.storageKey="caseedit-".concat(this.metadata.id);var g=localStorage.getItem(this.storageKey);if(this.savedWordEdits={},g)try{var y=JSON.parse(g);if(this.savedWordEdits=y.edit_list,Object.keys(y.metadata).length>0)for(var w=0,b=Object.entries(y.metadata);w<b.length;w++){var C=Object(l["a"])(b[w],2),_=C[0],k=Object(l["a"])(C[1],2),x=k[0],S=k[1];this.metadata[_]===x&&(this.metadata[_]=S)}}catch(O){console.log("Error applying edit_list to server state",O),localStorage.removeItem(this.storageKey)}this.extractWords()},mounted:function(){var t=this;document.addEventListener("keyup",function(e){if(e.ctrlKey)switch(e.key){case"o":t.showOcr=!t.showOcr;break;case"c":t.showConfidence=!t.showConfidence;break;case"s":t.saveCase();break;default:break}});var e=!0,n=!1,r=void 0;try{for(var a,i=this.pages.entries()[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){var o=Object(l["a"])(a.value,2),s=o[0],c=o[1];c.imageRef=this.$refs.pageImages[s]}}catch(d){n=!0,r=d}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}window.addEventListener("resize",function(){t.handleWindowResize()}),this.handleWindowResize(),this.mounted=!0},methods:{wordEdited:function(t){var e=this.currentWord;e.originalString===t?this.$delete(this.editedWords,e.id):this.$set(this.editedWords,e.id,e),e.string=t,e.stringWithoutSoftHyphens=e.string.replace(O,"")},paragraphBlocks:function(t){var e=this;return t.block_ids?t.block_ids.map(function(t){return e.blocksById[t]}):[]},currentWordStyle:function(){if(this.currentWord){var t=this.pagesByWordId[this.currentWord.id];return{"background-image":"url(".concat(t.image_url,")"),"background-size":"".concat(t.width,"px"),width:"".concat(this.currentWord.w,"px"),height:"".concat(this.currentWord.h,"px"),"background-position":"-".concat(this.currentWord.x,"px -").concat(this.currentWord.y,"px")}}return{width:"20rem",height:"2rem"}},wordImageStyle:function(t,e){var n=e.font;return{left:"".concat(e.x*t.scale,"px"),top:"".concat(e.y*t.scale-e.yOffset*t.fontScale-1,"px"),"background-color":this.showConfidence?e.wordConfidenceColor:"unset",font:"".concat(n.styles," ").concat(n.size*t.fontScale,"px/").concat(e.lineHeight*t.fontScale,"px ").concat(n.family)}},wordTextStyle:function(t){t.font;return{"background-color":this.showConfidence?t.wordConfidenceColor:"unset",font:"".concat(t.font.styles)}},wordClass:function(t){return{"current-word":this.currentWord===t,edited:t.string!==t.originalString}},wordClicked:function(t){this.currentWord=t,this.$refs.currentWord.focus(),this.scrollToWord(t.id)},wordConfidenceColor:function(t){var e=100*(.6-t.wordConfidence),n=255*t.wordConfidence+127;return"rgba(".concat(n,", 0, 0, ").concat(e,"%)")},handleWindowResize:function(){var t=this.$refs.pageImageContainer.offsetWidth,e=!0,n=!1,r=void 0;try{for(var a,i=this.pages[Symbol.iterator]();!(e=(a=i.next()).done);e=!0){var o=a.value;this.$set(o,"scale",t/o.width),o.fontScale=300*o.scale/72}}catch(s){n=!0,r=s}finally{try{e||null==i.return||i.return()}finally{if(n)throw r}}},extractWords:function(){var t=this,e=0;this.pagesByWordId={};var n=!0,r=!1,a=void 0;try{for(var i,o=this.pages[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var c=i.value,d=[],u=!0,h=!1,f=void 0;try{for(var v,p=function(){var n=v.value;if(n.words=[],!n.tokens)return"continue";var r=null,a=-1,i=t.savedWordEdits[c.id]&&t.savedWordEdits[c.id][n.id]?t.savedWordEdits[c.id][n.id]:{},o=!0,u=!1,h=void 0;try{for(var f,p=n.tokens.entries()[Symbol.iterator]();!(o=(f=p.next()).done);o=!0){var m=Object(l["a"])(f.value,2),g=m[0],y=m[1];if("string"!==typeof y){var w=Object(l["a"])(y,2),b=w[0],C=w[1];if("ocr"===b){var _=C.rect;r={blockId:n.id,wordConfidence:C.wc,font:t.fonts[a],strings:[],x:_[0],y:_[1],w:_[2],h:_[3]}}else if("/ocr"===b){if(!r)continue;if(r.strings.length){var k=d.length;r.index=k,r.originalString=r.strings.map(function(t){return t.value}).join("").replace(W,O),k in i&&i[k][0]===r.originalString?(r.string=i[k][1],t.editedWords[e]=r):r.string=r.originalString,r.stringWithoutSoftHyphens=r.string.replace(O,""),r.lineHeight=t.getFontLineHeight(a),r.yOffset=Math.min.apply(Math,Object(s["a"])(r.string.split("").map(function(e){return r.lineHeight-t.getCharAscent(e,a)}))),r.wordConfidenceColor=t.wordConfidenceColor(r),e++,r.id=e,d.push(r),n.words.push(r),t.pagesByWordId[e]=c}r=null}else"font"===b?a=C.id:"/font"===b&&(a=-1)}else r&&r.strings.push({index:g,value:y})}}catch(x){u=!0,h=x}finally{try{o||null==p.return||p.return()}finally{if(u)throw h}}},m=c.blocks[Symbol.iterator]();!(u=(v=m.next()).done);u=!0)p()}catch(g){h=!0,f=g}finally{try{u||null==m.return||m.return()}finally{if(h)throw f}}c.words=d}}catch(g){r=!0,a=g}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}},toggleInstructions:function(){var t=document.getElementById("instructions_modal_overlay");t.style.display="none"===t.style.display?"block":"none"},scrollToWord:function(t){S(this.$refs["wordText".concat(t)][0],{scrollMode:"if-needed"}),S(this.$refs["wordImage".concat(t)][0],{scrollMode:"if-needed"})},removeEdit:function(t){var e=this.editedWords[t];e.string=e.originalString,this.$delete(this.editedWords,t)},clearEdits:function(){if(confirm("CONFIRM: permanently discard your edits?\nThere is no undo for this command.")){localStorage.removeItem(this.storageKey),this.metadata=Object(c["a"])({},this.serverMetadata);var t=!0,e=!1,n=void 0;try{for(var r,a=this.pages[Symbol.iterator]();!(t=(r=a.next()).done);t=!0){var i=r.value,o=!0,s=!1,l=void 0;try{for(var d,u=i.words[Symbol.iterator]();!(o=(d=u.next()).done);o=!0){var h=d.value;h.string!==h.originalString&&(h.string=h.originalString)}}catch(f){s=!0,l=f}finally{try{o||null==u.return||u.return()}finally{if(s)throw l}}}}catch(f){e=!0,n=f}finally{try{t||null==a.return||a.return()}finally{if(e)throw n}}}},getMetadataEdits:function(){for(var t={},e=0,n=Object.entries(this.metadata);e<n.length;e++){var r=Object(l["a"])(n[e],2),a=r[0],i=r[1],o=this.serverMetadata[a];i!==o&&(t[a]=[o,i])}return t},getTokenEdits:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e={},n=!0,r=!1,a=void 0;try{for(var i,o=this.pages[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value,c=s.id,d=!0,u=!1,h=void 0;try{for(var f,v=s.words.entries()[Symbol.iterator]();!(d=(f=v.next()).done);d=!0){var p=Object(l["a"])(f.value,2),m=p[0],g=p[1];if(g.string!==g.originalString)if(e[c]||(e[c]={}),e[c][g.blockId]||(e[c][g.blockId]={}),t)e[c][g.blockId][m]=[g.originalString,g.string];else{var y=g.string.replace(O,W),w=!0,b=!1,C=void 0;try{for(var _,k=g.strings.entries()[Symbol.iterator]();!(w=(_=k.next()).done);w=!0){var x=Object(l["a"])(_.value,2),S=x[0],I=x[1];e[c][g.blockId][I.index]=[I.value,0===S?y:""]}}catch(E){b=!0,C=E}finally{try{w||null==k.return||k.return()}finally{if(b)throw C}}}}}catch(E){u=!0,h=E}finally{try{d||null==v.return||v.return()}finally{if(u)throw h}}}}catch(E){r=!0,a=E}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return e},getState:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return{metadata:this.getMetadataEdits(),edit_list:this.getTokenEdits(t)}},saveStateToStorage:f()(function(){var t=this.getState(!0);localStorage.setItem(this.storageKey,JSON.stringify(t))},500),saveCase:function(){var t=Object(o["a"])(regeneratorRuntime.mark(function t(){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(confirm("CONFIRM: permanently overwrite "+this.metadata.name+" in the CAP database with your edited version?\nThere is no undo for this command.")){t.next=2;break}return t.abrupt("return");case 2:return this.saveStatus="saving ...",t.prev=3,t.next=6,u.a.ajax("",{type:"POST",data:JSON.stringify(this.getState()),contentType:"application/json"}).promise();case 6:t.next=12;break;case 8:return t.prev=8,t.t0=t["catch"](3),this.saveStatus="error saving: ".concat(t.t0),t.abrupt("return");case 12:localStorage.removeItem(this.storageKey),window.location.href=this.urls.case;case 14:case"end":return t.stop()}},t,this,[[3,8]])}));function e(){return t.apply(this,arguments)}return e}(),getCharAscent:function(t,e){var n="".concat(e,"-").concat(t);if(!this.charAscentCache.hasOwnProperty(n)){var r=document.createElement("canvas"),a=r.getContext("2d"),i=this.fonts[e];a.font="".concat(i.styles," ").concat(i.size,"pt ").concat(i.family),this.charAscentCache[n]=3*a.measureText(t).actualBoundingBoxAscent/4}return this.charAscentCache[n]},getFontLineHeight:function(t){return this.getCharAscent("T",t)},addSoftHyphen:function(){this.currentWord.string=this.currentWord.string+O},processFont:function(t){var e=[];return t.style.includes("italics")&&e.push("italic"),t.style.includes("smallcaps")&&e.push("small-caps"),t.style.includes("bold")&&e.push("bold"),{family:'"'.concat(t.family,'",').concat(t.type),size:parseFloat(t.size),styles:e.join(" ")}}}},E=I,j=(n("7f94"),n("a6c2")),T=Object(j["a"])(E,a,i,!1,null,"6510eec5",null),M=T.exports;new r["default"]({el:"#app",components:{Main:M},template:"<Main/>"})},"7f94":function(t,e,n){"use strict";var r=n("052b"),a=n.n(r);a.a}});
//# sourceMappingURL=case-editor.85755952.js.map